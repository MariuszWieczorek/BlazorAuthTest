use MwTech;


-- Lista indeksów, które pomijamy w porównaniu
DECLARE @black_list table 
(
 id int identity(1, 1)
,ProductNumber varchar(30)
);


insert into @black_list  (productNumber) values ('DC781200NTR78KB')
insert into @black_list  (productNumber) values ('DC781200NTR78NT')
insert into @black_list  (productNumber) values ('DC781200TR78ANT')
insert into @black_list  (productNumber) values ('DC781200TR78KB')
insert into @black_list  (productNumber) values ('DC781200TR78NT')
insert into @black_list  (productNumber) values ('DC781400TR78AKB')
insert into @black_list  (productNumber) values ('DC781400TR78AKBK')
insert into @black_list  (productNumber) values ('KMEB1')
insert into @black_list  (productNumber) values ('KMEB2')
insert into @black_list  (productNumber) values ('KOIM13500101T-TE')
insert into @black_list  (productNumber) values ('KOSG1660081T-TE')
insert into @black_list  (productNumber) values ('MEM-23X5-NPP01')
insert into @black_list  (productNumber) values ('MSUEB1')
insert into @black_list  (productNumber) values ('MSUEB2')
insert into @black_list  (productNumber) values ('OBB-184-38-TE')
insert into @black_list  (productNumber) values ('OBC-184-38-TE')
insert into @black_list  (productNumber) values ('OBK- 235-001')
insert into @black_list  (productNumber) values ('OBK-184-38-TE')
insert into @black_list  (productNumber) values ('OBK-235-004-TE')
insert into @black_list  (productNumber) values ('ODP043')
insert into @black_list  (productNumber) values ('ODR-08-08-1960-01')
insert into @black_list  (productNumber) values ('ODR-10-00-20-TE')
insert into @black_list  (productNumber) values ('ODR-184-38-TE')
insert into @black_list  (productNumber) values ('OKA-0160-10-ITT')
insert into @black_list  (productNumber) values ('OKA-0190-10-ITT')
insert into @black_list  (productNumber) values ('OKG012P-CIETY-TE')
insert into @black_list  (productNumber) values ('OKG013P-184-38-TE')
insert into @black_list  (productNumber) values ('OKG013P-500-8-TE')
insert into @black_list  (productNumber) values ('OKG016P-CIETY-TE')
insert into @black_list  (productNumber) values ('OKG-149-28-CIETY-TE')
insert into @black_list  (productNumber) values ('OSMIM1008012101T-TE')
insert into @black_list  (productNumber) values ('OSMIM50013101T-TE')
insert into @black_list  (productNumber) values ('OSMSG1492881T-TE2')
insert into @black_list  (productNumber) values ('OSU1EV2842070133B1LR')
insert into @black_list  (productNumber) values ('OSUFM505017181L-TE')
insert into @black_list  (productNumber) values ('OSUIM50013101T-TE')
insert into @black_list  (productNumber) values ('SU-OD-SCIER')
insert into @black_list  (productNumber) values ('WOS140/55-9NPSNB1')
insert into @black_list  (productNumber) values ('WOZ1300R22.5ATK01/250BAR');
insert into @black_list  (productNumber) values ('KOSG2814981T-TE2');

-- do ustawienia jako nieaktywne
insert into @black_list  (productNumber) values ('DAP11L15TR15DO')
insert into @black_list  (productNumber) values ('DAP120018TR1500')
insert into @black_list  (productNumber) values ('DAP120020NTR300DO')
insert into @black_list  (productNumber) values ('DAP120020NTR300ES')
insert into @black_list  (productNumber) values ('DAP120020NTR300ET')
insert into @black_list  (productNumber) values ('DAP120020NTR300GW')
insert into @black_list  (productNumber) values ('DAP120020NTR300HT')
insert into @black_list  (productNumber) values ('DAP120020NTR300LL')
insert into @black_list  (productNumber) values ('DAP120020NTR300MI')
insert into @black_list  (productNumber) values ('DAP120020NTR300MT')
insert into @black_list  (productNumber) values ('DAP120020NTR300PA')
insert into @black_list  (productNumber) values ('DAP120020NTR300PC')
insert into @black_list  (productNumber) values ('DAP120020NTR300PL')
insert into @black_list  (productNumber) values ('DAP120020NTR300PN')
insert into @black_list  (productNumber) values ('DAP120020NTR300PR')
insert into @black_list  (productNumber) values ('DAP120020NTR300PT')
insert into @black_list  (productNumber) values ('DAP120020NTR300RG')
insert into @black_list  (productNumber) values ('DAP120020NTR300RN')
insert into @black_list  (productNumber) values ('DAP120020NTR300RW')
insert into @black_list  (productNumber) values ('DAP120020NTR300SF')
insert into @black_list  (productNumber) values ('DAP120020NTR300SO')
insert into @black_list  (productNumber) values ('DAP120020NTR300WE')
insert into @black_list  (productNumber) values ('DAP120020NTR300WZ')
insert into @black_list  (productNumber) values ('DAP120020NTR78ES')
insert into @black_list  (productNumber) values ('DAP120020NTR78ET')
insert into @black_list  (productNumber) values ('DAP120020NTR78GW')
insert into @black_list  (productNumber) values ('DAP120020NTR78HT')
insert into @black_list  (productNumber) values ('DAP120020NTR78MI')
insert into @black_list  (productNumber) values ('DAP120020NTR78MT')
insert into @black_list  (productNumber) values ('DAP120020NTR78PA')
insert into @black_list  (productNumber) values ('DAP120020NTR78PR')
insert into @black_list  (productNumber) values ('DAP120020NTR78RW')
insert into @black_list  (productNumber) values ('DAP120020NTR78SO')
insert into @black_list  (productNumber) values ('DAP120020NTR78WE')
insert into @black_list  (productNumber) values ('DAP120020NTR78WZ')
insert into @black_list  (productNumber) values ('DAP1258018TR1500')
insert into @black_list  (productNumber) values ('DAP13514515TR1300')
insert into @black_list  (productNumber) values ('DAP13614924TR21800')
insert into @black_list  (productNumber) values ('DAP13614928TR21800')
insert into @black_list  (productNumber) values ('DAP15512TR1500')
insert into @black_list  (productNumber) values ('DAP1657013TR1300')
insert into @black_list  (productNumber) values ('DAP16918434TR21800')
insert into @black_list  (productNumber) values ('DAP17518515TR1300')
insert into @black_list  (productNumber) values ('DAP18426TR21800')
insert into @black_list  (productNumber) values ('DAP18430TR21800')
insert into @black_list  (productNumber) values ('DAP18438TR21800')
insert into @black_list  (productNumber) values ('DAP1878TR1300')
insert into @black_list  (productNumber) values ('DAP23126TR21800')
insert into @black_list  (productNumber) values ('DAP70012TR1300')
insert into @black_list  (productNumber) values ('DAP70015VFI5700')
insert into @black_list  (productNumber) values ('DAP75015TR1300')
insert into @black_list  (productNumber) values ('DAP82520TR21800')
insert into @black_list  (productNumber) values ('DC15825TR75A00')
insert into @black_list  (productNumber) values ('DC15825V00')
insert into @black_list  (productNumber) values ('DC16750TR75APLWK')
insert into @black_list  (productNumber) values ('DC16825V00')
insert into @black_list  (productNumber) values ('DC16900V00')
insert into @black_list  (productNumber) values ('DC201000V368ETWK')
insert into @black_list  (productNumber) values ('DC201100TR78APLWK')
insert into @black_list  (productNumber) values ('DC201200TR78APLWK')
insert into @black_list  (productNumber) values ('DC201600V368ETWK')
insert into @black_list  (productNumber) values ('DC20825TR21800')
insert into @black_list  (productNumber) values ('DC20825V3210WZ')
insert into @black_list  (productNumber) values ('DC20900TR21800')
insert into @black_list  (productNumber) values ('DC20900V00')
insert into @black_list  (productNumber) values ('DC20900V368ETWK')
insert into @black_list  (productNumber) values ('DC241300TR17900')
insert into @black_list  (productNumber) values ('DC241300TR179AETWK')
insert into @black_list  (productNumber) values ('DC241300TR21800')
insert into @black_list  (productNumber) values ('DC25265HDV00')
insert into @black_list  (productNumber) values ('DC25265PREMV00')
insert into @black_list  (productNumber) values ('DC5331300530V00')
insert into @black_list  (productNumber) values ('DC781200NTR78ESWK')
insert into @black_list  (productNumber) values ('DC781200NTR78ETWK')
insert into @black_list  (productNumber) values ('DC781200NTR78GW')
insert into @black_list  (productNumber) values ('DC781200NTR78HTWK')
insert into @black_list  (productNumber) values ('DC781200NTR78MIWK')
insert into @black_list  (productNumber) values ('DC781200NTR78MTWK')
insert into @black_list  (productNumber) values ('DC781200NTR78PAWK')
insert into @black_list  (productNumber) values ('DC781200NTR78PRWK')
insert into @black_list  (productNumber) values ('DC781200NTR78RWWK')
insert into @black_list  (productNumber) values ('DC781200NTR78SOWK')
insert into @black_list  (productNumber) values ('DC781200NTR78WE')
insert into @black_list  (productNumber) values ('DC781200NTR78WZ')
insert into @black_list  (productNumber) values ('DC781200TR78PLWK')
insert into @black_list  (productNumber) values ('DC781400TR78PLWK')
insert into @black_list  (productNumber) values ('DKJ120020NTR300DO')
insert into @black_list  (productNumber) values ('DKJ120020NTR300ES')
insert into @black_list  (productNumber) values ('DKJ120020NTR300ET')
insert into @black_list  (productNumber) values ('DKJ120020NTR300GW')
insert into @black_list  (productNumber) values ('DKJ120020NTR300HT')
insert into @black_list  (productNumber) values ('DKJ120020NTR300LL')
insert into @black_list  (productNumber) values ('DKJ120020NTR300MI')
insert into @black_list  (productNumber) values ('DKJ120020NTR300MT')
insert into @black_list  (productNumber) values ('DKJ120020NTR300PA')
insert into @black_list  (productNumber) values ('DKJ120020NTR300PC')
insert into @black_list  (productNumber) values ('DKJ120020NTR300PL')
insert into @black_list  (productNumber) values ('DKJ120020NTR300PN')
insert into @black_list  (productNumber) values ('DKJ120020NTR300PR')
insert into @black_list  (productNumber) values ('DKJ120020NTR300PT')
insert into @black_list  (productNumber) values ('DKJ120020NTR300RG')
insert into @black_list  (productNumber) values ('DKJ120020NTR300RN')
insert into @black_list  (productNumber) values ('DKJ120020NTR300RW')
insert into @black_list  (productNumber) values ('DKJ120020NTR300SF')
insert into @black_list  (productNumber) values ('DKJ120020NTR300SO')
insert into @black_list  (productNumber) values ('DKJ120020NTR300WE')
insert into @black_list  (productNumber) values ('DKJ120020NTR300WZ')
insert into @black_list  (productNumber) values ('DKJ120020NTR78ES')
insert into @black_list  (productNumber) values ('DKJ120020NTR78ET')
insert into @black_list  (productNumber) values ('DKJ120020NTR78GW')
insert into @black_list  (productNumber) values ('DKJ120020NTR78HT')
insert into @black_list  (productNumber) values ('DKJ120020NTR78MI')
insert into @black_list  (productNumber) values ('DKJ120020NTR78MT')
insert into @black_list  (productNumber) values ('DKJ120020NTR78PA')
insert into @black_list  (productNumber) values ('DKJ120020NTR78PR')
insert into @black_list  (productNumber) values ('DKJ120020NTR78RW')
insert into @black_list  (productNumber) values ('DKJ120020NTR78SO')
insert into @black_list  (productNumber) values ('DKJ120020NTR78WE')
insert into @black_list  (productNumber) values ('DKJ120020NTR78WZ')
insert into @black_list  (productNumber) values ('DO12135TR1500')
insert into @black_list  (productNumber) values ('DO12155TR1300')
insert into @black_list  (productNumber) values ('DO12155TR218C00')
insert into @black_list  (productNumber) values ('DO15135145TR1500')
insert into @black_list  (productNumber) values ('DO15145155TR13ETWK')
insert into @black_list  (productNumber) values ('DO15175185TR1500')
insert into @black_list  (productNumber) values ('DO1619400TR13ETWK')
insert into @black_list  (productNumber) values ('DO16600650TR1300')
insert into @black_list  (productNumber) values ('DO16600650TR1500')
insert into @black_list  (productNumber) values ('DO16600650TR21800')
insert into @black_list  (productNumber) values ('DO16600650TR7500')
insert into @black_list  (productNumber) values ('DOB1121242800')
insert into @black_list  (productNumber) values ('DOB11L15DO')
insert into @black_list  (productNumber) values ('DOB12001800')
insert into @black_list  (productNumber) values ('DOB130024BLS')
insert into @black_list  (productNumber) values ('DOB1351200')
insert into @black_list  (productNumber) values ('DOB1361492400')
insert into @black_list  (productNumber) values ('DOB1551693800')
insert into @black_list  (productNumber) values ('DOB169142400')
insert into @black_list  (productNumber) values ('DOB1691843400')
insert into @black_list  (productNumber) values ('DOB1751851500')
insert into @black_list  (productNumber) values ('DOB1842600')
insert into @black_list  (productNumber) values ('DOB1843000')
insert into @black_list  (productNumber) values ('DOB1843800')
insert into @black_list  (productNumber) values ('DOB187800')
insert into @black_list  (productNumber) values ('DOB2312600')
insert into @black_list  (productNumber) values ('DOB23126C00')
insert into @black_list  (productNumber) values ('DOB40044010C00')
insert into @black_list  (productNumber) values ('DOB400600')
insert into @black_list  (productNumber) values ('DOB5005506022500')
insert into @black_list  (productNumber) values ('DOB7001200')
insert into @black_list  (productNumber) values ('DOB7501500')
insert into @black_list  (productNumber) values ('DR1210080TR15ETWK')
insert into @black_list  (productNumber) values ('DR1210080TR75A00')
insert into @black_list  (productNumber) values ('DR15310075TR15ETWK')
insert into @black_list  (productNumber) values ('DR15312580TR1300')
insert into @black_list  (productNumber) values ('DR15312580TR21800')
insert into @black_list  (productNumber) values ('DR15540060TR15ETWK')
insert into @black_list  (productNumber) values ('DR1610565TR15ETWK')
insert into @black_list  (productNumber) values ('DR1612065TR15ETWK')
insert into @black_list  (productNumber) values ('DR16510650TR15ETWK')
insert into @black_list  (productNumber) values ('DR16650HDTR15ETWK')
insert into @black_list  (productNumber) values ('DR1715055TR15ETWK')
insert into @black_list  (productNumber) values ('DR1719045TR15ETWK')
insert into @black_list  (productNumber) values ('DR181200V00')
insert into @black_list  (productNumber) values ('DR1812575TR15ETWK')
insert into @black_list  (productNumber) values ('DR1813065TR15ETWK')
insert into @black_list  (productNumber) values ('DR181500TR1500')
insert into @black_list  (productNumber) values ('DR1815070TR15ETWK')
insert into @black_list  (productNumber) values ('DR18750TR218AETWK')
insert into @black_list  (productNumber) values ('DR2010580TR1500')
insert into @black_list  (productNumber) values ('DR2010580TR15ETWK')
insert into @black_list  (productNumber) values ('DR2012580TR15ETWK')
insert into @black_list  (productNumber) values ('DR2014580TR15ETWK')
insert into @black_list  (productNumber) values ('DR2016070TR15ETWK')
insert into @black_list  (productNumber) values ('DR2016070TR21800')
insert into @black_list  (productNumber) values ('DR20700750TR15ETWK')
insert into @black_list  (productNumber) values ('DR2251000TR300ETWK')
insert into @black_list  (productNumber) values ('DR2251100TR300ETWK')
insert into @black_list  (productNumber) values ('DR2251300TR300ETWK')
insert into @black_list  (productNumber) values ('DR2251500TR300ETWK')
insert into @black_list  (productNumber) values ('DR22516518TR21800')
insert into @black_list  (productNumber) values ('DR22516518TR300ETWK')
insert into @black_list  (productNumber) values ('DR22516518V00')
insert into @black_list  (productNumber) values ('DR22550055060TR218C00')
insert into @black_list  (productNumber) values ('DR22550060TR218AETWK')
insert into @black_list  (productNumber) values ('DR24112124TR21800')
insert into @black_list  (productNumber) values ('DR24112124TR218C00')
insert into @black_list  (productNumber) values ('DR24112124TR218PLWK')
insert into @black_list  (productNumber) values ('DR24112124TR218WE')
insert into @black_list  (productNumber) values ('DR24112TR218ETWK')
insert into @black_list  (productNumber) values ('DR24124136HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR24124136TR218AETWK')
insert into @black_list  (productNumber) values ('DR24124136TR218C00')
insert into @black_list  (productNumber) values ('DR24124HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR24136149TR218C00')
insert into @black_list  (productNumber) values ('DR24136149TR222000')
insert into @black_list  (productNumber) values ('DR24149HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR24149TR218AETWK')
insert into @black_list  (productNumber) values ('DR24149TR218APLWK')
insert into @black_list  (productNumber) values ('DR241558016585TR218ETWK')
insert into @black_list  (productNumber) values ('DR241600TRJ1175CPLWK')
insert into @black_list  (productNumber) values ('DR2416914HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR24169TR218ETWK')
insert into @black_list  (productNumber) values ('DR24184HDTR218APLWK')
insert into @black_list  (productNumber) values ('DR25155TRJ1175CPLWK')
insert into @black_list  (productNumber) values ('DR25170180SP400000')
insert into @black_list  (productNumber) values ('DR25175TRJ1175CPLWK')
insert into @black_list  (productNumber) values ('DR251800TRJ1175CETWK')
insert into @black_list  (productNumber) values ('DR251800TRJ1175CPLWK')
insert into @black_list  (productNumber) values ('DR252051175CETWK')
insert into @black_list  (productNumber) values ('DR252051175CPLWK')
insert into @black_list  (productNumber) values ('DR252351175CPLWK')
insert into @black_list  (productNumber) values ('DR25265TRJ1175PLWK')
insert into @black_list  (productNumber) values ('DR25295DTRJ1175CPLWK')
insert into @black_list  (productNumber) values ('DR26169184TR218PLWK')
insert into @black_list  (productNumber) values ('DR26184TR218C00')
insert into @black_list  (productNumber) values ('DR26184TR218D00')
insert into @black_list  (productNumber) values ('DR26231HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR26231TR218C00')
insert into @black_list  (productNumber) values ('DR26281HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR26550060TR218AETWK')
insert into @black_list  (productNumber) values ('DR28112124TR21800')
insert into @black_list  (productNumber) values ('DR28112124TR218C00')
insert into @black_list  (productNumber) values ('DR28112TR218ETWK')
insert into @black_list  (productNumber) values ('DR28136149TR21800')
insert into @black_list  (productNumber) values ('DR28136149TR218C00')
insert into @black_list  (productNumber) values ('DR28136149TR218GRWK')
insert into @black_list  (productNumber) values ('DR28136TR218AETWK')
insert into @black_list  (productNumber) values ('DR28169HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR28184TR218ETWK')
insert into @black_list  (productNumber) values ('DR30149155TR218AETWK')
insert into @black_list  (productNumber) values ('DR3016914TR21800')
insert into @black_list  (productNumber) values ('DR30169184TR218RGWK')
insert into @black_list  (productNumber) values ('DR30169TR218APLWK')
insert into @black_list  (productNumber) values ('DR30169TR218ETWK')
insert into @black_list  (productNumber) values ('DR30184TR218ETWK')
insert into @black_list  (productNumber) values ('DR32245TR218ETWK')
insert into @black_list  (productNumber) values ('DR34169184HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR34169184TR21800')
insert into @black_list  (productNumber) values ('DR34169184TR218C00')
insert into @black_list  (productNumber) values ('DR34169184TR218PLWK')
insert into @black_list  (productNumber) values ('DR36112TR218ETWK')
insert into @black_list  (productNumber) values ('DR38136149TR218C00')
insert into @black_list  (productNumber) values ('DR38155169TR218C00')
insert into @black_list  (productNumber) values ('DR38169HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR38169TR218AETWK')
insert into @black_list  (productNumber) values ('DR38169TR218APLWK')
insert into @black_list  (productNumber) values ('DR38184BTR218DOWK')
insert into @black_list  (productNumber) values ('DR38184HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR38184TR218C00')
insert into @black_list  (productNumber) values ('DR38184TR218ETWK')
insert into @black_list  (productNumber) values ('DR38184TR218RGWK')
insert into @black_list  (productNumber) values ('DR38208HDTR218AETWK')
insert into @black_list  (productNumber) values ('DR428395TR218AETWK')
insert into @black_list  (productNumber) values ('DR44112TR218AETWK')
insert into @black_list  (productNumber) values ('DR4483TR218AETWK')
insert into @black_list  (productNumber) values ('DR48112TR218AETWK')
insert into @black_list  (productNumber) values ('DST1008012TR7500')
insert into @black_list  (productNumber) values ('DST120018TR1500')
insert into @black_list  (productNumber) values ('DST120020NTR300DO')
insert into @black_list  (productNumber) values ('DST120020NTR300ES')
insert into @black_list  (productNumber) values ('DST120020NTR300ET')
insert into @black_list  (productNumber) values ('DST120020NTR300GW')
insert into @black_list  (productNumber) values ('DST120020NTR300HT')
insert into @black_list  (productNumber) values ('DST120020NTR300LL')
insert into @black_list  (productNumber) values ('DST120020NTR300MI')
insert into @black_list  (productNumber) values ('DST120020NTR300MT')
insert into @black_list  (productNumber) values ('DST120020NTR300PA')
insert into @black_list  (productNumber) values ('DST120020NTR300PC')
insert into @black_list  (productNumber) values ('DST120020NTR300PL')
insert into @black_list  (productNumber) values ('DST120020NTR300PN')
insert into @black_list  (productNumber) values ('DST120020NTR300PR')
insert into @black_list  (productNumber) values ('DST120020NTR300PT')
insert into @black_list  (productNumber) values ('DST120020NTR300RG')
insert into @black_list  (productNumber) values ('DST120020NTR300RN')
insert into @black_list  (productNumber) values ('DST120020NTR300RW')
insert into @black_list  (productNumber) values ('DST120020NTR300SF')
insert into @black_list  (productNumber) values ('DST120020NTR300SO')
insert into @black_list  (productNumber) values ('DST120020NTR300WE')
insert into @black_list  (productNumber) values ('DST120020NTR300WZ')
insert into @black_list  (productNumber) values ('DST120020NTR78ES')
insert into @black_list  (productNumber) values ('DST120020NTR78ET')
insert into @black_list  (productNumber) values ('DST120020NTR78GW')
insert into @black_list  (productNumber) values ('DST120020NTR78HT')
insert into @black_list  (productNumber) values ('DST120020NTR78MI')
insert into @black_list  (productNumber) values ('DST120020NTR78MT')
insert into @black_list  (productNumber) values ('DST120020NTR78PA')
insert into @black_list  (productNumber) values ('DST120020NTR78PR')
insert into @black_list  (productNumber) values ('DST120020NTR78RW')
insert into @black_list  (productNumber) values ('DST120020NTR78SO')
insert into @black_list  (productNumber) values ('DST120020NTR78WE')
insert into @black_list  (productNumber) values ('DST120020NTR78WZ')
insert into @black_list  (productNumber) values ('DST12413636TR21800')
insert into @black_list  (productNumber) values ('DST1258018TR1500')
insert into @black_list  (productNumber) values ('DST1258018TR21800')
insert into @black_list  (productNumber) values ('DST13614928TR21800')
insert into @black_list  (productNumber) values ('DST18426TR21800')
insert into @black_list  (productNumber) values ('DST18430TR21800')
insert into @black_list  (productNumber) values ('DST70012TR1300')
insert into @black_list  (productNumber) values ('DST90016VFI5700')
insert into @black_list  (productNumber) values ('DST90020TR21800')
insert into @black_list  (productNumber) values ('DT10400440TR1300')
insert into @black_list  (productNumber) values ('DT10400440TR1500')
insert into @black_list  (productNumber) values ('DT10400440TR218C00')
insert into @black_list  (productNumber) values ('DT10650JS2ETWK')
insert into @black_list  (productNumber) values ('DT10650JS2FI45PLWK')
insert into @black_list  (productNumber) values ('DT1224900TR13ETWK')
insert into @black_list  (productNumber) values ('DT12261200TR13ETWK')
insert into @black_list  (productNumber) values ('DT122710JS2ETWK')
insert into @black_list  (productNumber) values ('DT12700JS2FI4500')
insert into @black_list  (productNumber) values ('DT12700JS2PLWK')
insert into @black_list  (productNumber) values ('DT12700TR1500')
insert into @black_list  (productNumber) values ('DT12700TR75A00')
insert into @black_list  (productNumber) values ('DT15250300TR75APLWK')
insert into @black_list  (productNumber) values ('DT15300TR78ETWK')
insert into @black_list  (productNumber) values ('DT15300TR78PLWK')
insert into @black_list  (productNumber) values ('DT15700TR1500')
insert into @black_list  (productNumber) values ('DT15700V00')
insert into @black_list  (productNumber) values ('DT15700VTR75A00')
insert into @black_list  (productNumber) values ('DT15750JS2FI4500')
insert into @black_list  (productNumber) values ('DT15750JS2FI5700')
insert into @black_list  (productNumber) values ('DT622050TR13ETWK')
insert into @black_list  (productNumber) values ('DT8187TR8700')
insert into @black_list  (productNumber) values ('DT818850GP4DOWK')
insert into @black_list  (productNumber) values ('DT8188595TR1300')
insert into @black_list  (productNumber) values ('DT9251300TR13ETWK')
insert into @black_list  (productNumber) values ('DT9600JS2FI45PLWK')
insert into @black_list  (productNumber) values ('DT9600TR15ETWK')
insert into @black_list  (productNumber) values ('DT9600V00')
insert into @black_list  (productNumber) values ('DWU1008012TR1300')
insert into @black_list  (productNumber) values ('DWU1008012VFI57AT')
insert into @black_list  (productNumber) values ('DWU1058020TR21800')
insert into @black_list  (productNumber) values ('DWU110020VFI7000')
insert into @black_list  (productNumber) values ('DWU11212424TR21800')
insert into @black_list  (productNumber) values ('DWU11212424TR218C00')
insert into @black_list  (productNumber) values ('DWU11212424TR218DPA')
insert into @black_list  (productNumber) values ('DWU11212428TR21800')
insert into @black_list  (productNumber) values ('DWU11212428TR218DPA')
insert into @black_list  (productNumber) values ('DWU11580153TR1300')
insert into @black_list  (productNumber) values ('DWU11L15TR15DO')
insert into @black_list  (productNumber) values ('DWU120018TR1500')
insert into @black_list  (productNumber) values ('DWU120018TR21800')
insert into @black_list  (productNumber) values ('DWU120018V00')
insert into @black_list  (productNumber) values ('DWU120020NTR300DO')
insert into @black_list  (productNumber) values ('DWU120020NTR300ES')
insert into @black_list  (productNumber) values ('DWU120020NTR300ET')
insert into @black_list  (productNumber) values ('DWU120020NTR300GW')
insert into @black_list  (productNumber) values ('DWU120020NTR300HT')
insert into @black_list  (productNumber) values ('DWU120020NTR300LL')
insert into @black_list  (productNumber) values ('DWU120020NTR300MI')
insert into @black_list  (productNumber) values ('DWU120020NTR300MT')
insert into @black_list  (productNumber) values ('DWU120020NTR300PA')
insert into @black_list  (productNumber) values ('DWU120020NTR300PC')
insert into @black_list  (productNumber) values ('DWU120020NTR300PL')
insert into @black_list  (productNumber) values ('DWU120020NTR300PN')
insert into @black_list  (productNumber) values ('DWU120020NTR300PR')
insert into @black_list  (productNumber) values ('DWU120020NTR300PT')
insert into @black_list  (productNumber) values ('DWU120020NTR300RG')
insert into @black_list  (productNumber) values ('DWU120020NTR300RN')
insert into @black_list  (productNumber) values ('DWU120020NTR300RW')
insert into @black_list  (productNumber) values ('DWU120020NTR300SF')
insert into @black_list  (productNumber) values ('DWU120020NTR300SO')
insert into @black_list  (productNumber) values ('DWU120020NTR300WE')
insert into @black_list  (productNumber) values ('DWU120020NTR300WZ')
insert into @black_list  (productNumber) values ('DWU120020NTR78ES')
insert into @black_list  (productNumber) values ('DWU120020NTR78ET')
insert into @black_list  (productNumber) values ('DWU120020NTR78GW')
insert into @black_list  (productNumber) values ('DWU120020NTR78HT')
insert into @black_list  (productNumber) values ('DWU120020NTR78MI')
insert into @black_list  (productNumber) values ('DWU120020NTR78MT')
insert into @black_list  (productNumber) values ('DWU120020NTR78PA')
insert into @black_list  (productNumber) values ('DWU120020NTR78PR')
insert into @black_list  (productNumber) values ('DWU120020NTR78RW')
insert into @black_list  (productNumber) values ('DWU120020NTR78SO')
insert into @black_list  (productNumber) values ('DWU120020NTR78WE')
insert into @black_list  (productNumber) values ('DWU120020NTR78WZ')
insert into @black_list  (productNumber) values ('DWU12413624TR21800')
insert into @black_list  (productNumber) values ('DWU12413636TR21800')
insert into @black_list  (productNumber) values ('DWU12580153TR1300')
insert into @black_list  (productNumber) values ('DWU12580153TR1500')
insert into @black_list  (productNumber) values ('DWU1258018TR1500')
insert into @black_list  (productNumber) values ('DWU1258018TR21800')
insert into @black_list  (productNumber) values ('DWU130024VFI7000')
insert into @black_list  (productNumber) values ('DWU13512TR1300')
insert into @black_list  (productNumber) values ('DWU13512TR1500')
insert into @black_list  (productNumber) values ('DWU13514515TR1300')
insert into @black_list  (productNumber) values ('DWU13614924TR21800')
insert into @black_list  (productNumber) values ('DWU13614924TR218DPA')
insert into @black_list  (productNumber) values ('DWU13614924TR22000')
insert into @black_list  (productNumber) values ('DWU13614928TR21800')
insert into @black_list  (productNumber) values ('DWU13614928TR218DPA')
insert into @black_list  (productNumber) values ('DWU13614938TR21800')
insert into @black_list  (productNumber) values ('DWU13614938TR218C00')
insert into @black_list  (productNumber) values ('DWU13614938TR218DPA')
insert into @black_list  (productNumber) values ('DWU140020VFI7000')
insert into @black_list  (productNumber) values ('DWU140020VFI70AT')
insert into @black_list  (productNumber) values ('DWU150018TR21800')
insert into @black_list  (productNumber) values ('DWU150021V590E00')
insert into @black_list  (productNumber) values ('DWU15512TR1300')
insert into @black_list  (productNumber) values ('DWU15512TR1500')
insert into @black_list  (productNumber) values ('DWU15516514TR1300')
insert into @black_list  (productNumber) values ('DWU15516938TR21800')
insert into @black_list  (productNumber) values ('DWU15516938TR218DPA')
insert into @black_list  (productNumber) values ('DWU1607020TR1500')
insert into @black_list  (productNumber) values ('DWU1607020TR21800')
insert into @black_list  (productNumber) values ('DWU1607020VFI7000')
insert into @black_list  (productNumber) values ('DWU1657013TR1300')
insert into @black_list  (productNumber) values ('DWU1691424TR21800')
insert into @black_list  (productNumber) values ('DWU1691424TR218DPA')
insert into @black_list  (productNumber) values ('DWU1691430TR21800')
insert into @black_list  (productNumber) values ('DWU1691430TR218DPA')
insert into @black_list  (productNumber) values ('DWU16918434TR21800')
insert into @black_list  (productNumber) values ('DWU16918434TR218C00')
insert into @black_list  (productNumber) values ('DWU16930TR21800')
insert into @black_list  (productNumber) values ('DWU17018025TRJ00')
insert into @black_list  (productNumber) values ('DWU17518514TR1300')
insert into @black_list  (productNumber) values ('DWU17518515TR1500')
insert into @black_list  (productNumber) values ('DWU18426TR21800')
insert into @black_list  (productNumber) values ('DWU18426TR218C00')
insert into @black_list  (productNumber) values ('DWU18426TR218D00')
insert into @black_list  (productNumber) values ('DWU18430TR21800')
insert into @black_list  (productNumber) values ('DWU18438TR21800')
insert into @black_list  (productNumber) values ('DWU18438TR218C00')
insert into @black_list  (productNumber) values ('DWU1878TR1300')
insert into @black_list  (productNumber) values ('DWU1878TR87FI4500')
insert into @black_list  (productNumber) values ('DWU1885958TR1300')
insert into @black_list  (productNumber) values ('DWU20838TR21800')
insert into @black_list  (productNumber) values ('DWU20838TR218DPA')
insert into @black_list  (productNumber) values ('DWU23126TR21800')
insert into @black_list  (productNumber) values ('DWU23126TR218C00')
insert into @black_list  (productNumber) values ('DWU23126TR218DPA')
insert into @black_list  (productNumber) values ('DWU27530016GP4AT')
insert into @black_list  (productNumber) values ('DWU40044010TR1300')
insert into @black_list  (productNumber) values ('DWU40044010TR1500')
insert into @black_list  (productNumber) values ('DWU40044010TR218C00')
insert into @black_list  (productNumber) values ('DWU4006TR1300')
insert into @black_list  (productNumber) values ('DWU50055060225TR21800')
insert into @black_list  (productNumber) values ('DWU50055060225VFI7000')
insert into @black_list  (productNumber) values ('DWU55060016TR1300')
insert into @black_list  (productNumber) values ('DWU60065016ETR15TG')
insert into @black_list  (productNumber) values ('DWU60065016TR1500')
insert into @black_list  (productNumber) values ('DWU60065016TR21800')
insert into @black_list  (productNumber) values ('DWU6009VFI5700')
insert into @black_list  (productNumber) values ('DWU70012JS2FI4500')
insert into @black_list  (productNumber) values ('DWU70012TR1300')
insert into @black_list  (productNumber) values ('DWU70012TR1500')
insert into @black_list  (productNumber) values ('DWU70012V00')
insert into @black_list  (productNumber) values ('DWU70015TR1500')
insert into @black_list  (productNumber) values ('DWU70015V00')
insert into @black_list  (productNumber) values ('DWU70075020TR1500')
insert into @black_list  (productNumber) values ('DWU75015TR1300')
insert into @black_list  (productNumber) values ('DWU75015TR1500')
insert into @black_list  (productNumber) values ('DWU75016TR1500')
insert into @black_list  (productNumber) values ('DWU81515V00')
insert into @black_list  (productNumber) values ('DWU82515TR7500')
insert into @black_list  (productNumber) values ('DWU82515V00')
insert into @black_list  (productNumber) values ('DWU82520TR21800')
insert into @black_list  (productNumber) values ('DWU90016V00')
insert into @black_list  (productNumber) values ('DWU90020V00')
insert into @black_list  (productNumber) values ('DWY130024BLS')
insert into @black_list  (productNumber) values ('DWY-290X990X2.2-DS55')
insert into @black_list  (productNumber) values ('OC19500KB-TE')
insert into @black_list  (productNumber) values ('SK3-HDQ-0001-01');
--
insert into @black_list  (productNumber) values ('OKG000');

/* Zestawienie ró¿nic tego co jest w IFS z tym co jest w MwTech */
WITH structures_compare AS (

SELECT *
FROM (
SELECT ifs.CONTRACT
,ca.CategoryNumber as CATEGORY_NO
,ifs.PART_NO as PART_NO
,ifs.ALTERNATIVE as ALTERNATIVE
,ifs.REVISION as REVISION
,ifs.LINE_SEQUENCE as LINE_SEQUENCE
,ifs.COMPONENT_PART as ifs_COMPONENT_PART
,ISNULL(mw.COMPONENT_PART,'') as mw_COMPONENT_PART
,ifs.QTY_PER_ASSEMBLY as ifs_QTY_PER_ASSEMBLY
,ISNULL(mw.QTY_PER_ASSEMBLY,0) as mw_QTY_PER_ASSEMBLY
,ifs.SHRINKAGE_FACTOR as ifs_SHRINKAGE_FACTOR
,ISNULL(mw.SHRINKAGE_FACTOR,0) as mw_SHRINKAGE_FACTOR
,pr.IsActive as IsProductActive
-- TESTS
,iif(ifs.SHRINKAGE_FACTOR = mw.SHRINKAGE_FACTOR,1,0) as  SHRINKAGE_FACTOR_TEST
,iif(round(ifs.QTY_PER_ASSEMBLY,2) = round(mw.QTY_PER_ASSEMBLY,2),1,0) as  QTY_PER_ASSEMBLY_TEST
,iif(ifs.COMPONENT_PART = mw.COMPONENT_PART,1,0) as  COMPONENT_PART_TEST
,iif(pr.ProductNumber is not null,1,0) as NO_PART_NO
,iif(mw.ALTERNATIVE is not null,1,0) as NO_ALTERNATIVE
,iif(mw.REVISION is not null,1,0) as NO_REVISION
--
FROM dbo.ifs_struktury as ifs
LEFT JOIN dbo.Products as pr
ON trim(pr.ProductNumber) = trim(ifs.Part_no)
LEFT JOIN dbo.ProductCategories as ca
ON ca.Id = pr.ProductCategoryId

LEFT JOIN dbo.mwtech_bom_ifs as mw
ON 1 = 1
AND mw.QTY_PER_ASSEMBLY > 0 -- bez ujemnych iloci
AND iif(ifs.ALTERNATIVE = '*',1,ifs.ALTERNATIVE) = mw.ALTERNATIVE -- bo w kursorze mw mam wartoci * zamiast 1
AND iif(ifs.REVISION = '*',1,ifs.REVISION) = mw.REVISION
AND mw.PART_NO = ifs.PART_NO
--AND mw.COMPONENT_PART = ifs.COMPONENT_PART
AND mw.LINE_SEQUENCE = ifs.LINE_SEQUENCE
--
WHERE 1 = 1
AND (ISNUMERIC(ifs.ALTERNATIVE)=1 OR ifs.ALTERNATIVE = '*')
AND (ISNUMERIC(ifs.REVISION)=1 OR ifs.REVISION = '*')
) as x
WHERE 1 = 1
AND (( COMPONENT_PART_TEST + QTY_PER_ASSEMBLY_TEST + NO_PART_NO + NO_ALTERNATIVE + NO_REVISION < 5 ) OR isProductActive = 0)

)

select * 
from structures_compare as x
where 1 = 1
AND PART_NO not in (select ProductNumber from @black_list)
AND PART_NO not like 'KO%G2' -- odrzucamy drugie gatunki
AND PART_NO not like 'MEM-%' -- odrzucamy membrany
AND PART_NO not like '%-TE' -- odrzucamy testowe
-- AND CATEGORY_NO not like 'USL%' -- odrzucamy us³ugi
-- AND PART_NO = 'KOSG2411281T'
-- and NO_REVISION = 0
-- AND ifs_PART_NO like 'OS%'
ORDER BY x.CONTRACT, x.CATEGORY_NO, x.PART_NO, x.REVISION, x.ALTERNATIVE

