/****** Script for SelectTopNRows command from SSMS  ******/
declare @OperationNo varchar(50);
declare @OperationId int;
declare @ProductNo varchar(50);
declare @WorkCenterId int;
declare @WorkCenterNo varchar(10);
set @OperationNo= 'OSU-KONFEKCJA';
set @OperationId = (select op.Id from [MwTech].[dbo].[Operations] as op where op.OperationNumber = @OperationNo) 
-- zmiennne

DECLARE @tabConvert table (id int identity(1, 1),
ProductNo varchar(50),
WorkCenterNo varchar(10));

insert into @tabConvert (ProductNo,WorkCenterNo) values
('OSUGT16928121L','MK06'),
('OSUGT16928121L-TE','MK06'),
('OSUGT16928141L','MK06'),
('OSUGT16928141L-TE','MK06'),
('OSUGT3408018121L','TB3'),
('OSUGT3408018141L','TB3'),
('OSUGT3408018141L-TE','TB3'),
('OSUIM10075153101L','TB1'),
('OSUIM10075153101T','TB1'),
('OSUIM10075153121I','TB1'),
('OSUIM10075153121L','TB1'),
('OSUIM10075153121T','TB1'),
('OSUIM10075153141I','TB1'),
('OSUIM10075153141L','TB1'),
('OSUIM10075153141T','TB1'),
('OSUIM1008012101L','HERB'),
('OSUIM1008012101L-TE','HERB'),
('OSUIM1008012101T','HERB'),
('OSUIM100801281L','HERB'),
('OSUIM100801281L-TE','HERB'),
('OSUIM100801281T','HERB'),
('OSUIM1056516121T','TB2'),
('OSUIM1056516121T-TE','TB2'),
('OSUIM11580153121T','TB2'),
('OSUIM11580153141I','TB2'),
('OSUIM11580153141L','TB2'),
('OSUIM11580153141T','TB2'),
('OSUIM11580153161L','TB2'),
('OSUIM11580153161T','TB2'),
('OSUIM1306518161T','TB3'),
('OSUIM1306518161T-TE','TB3'),
('OSUIM15600661L','MK01'),
('OSUIM15600661T','MK01'),
('OSUIM15600662L','MK01'),
('OSUIM15600662T','MK01'),
('OSUIM16650861L','MK01'),
('OSUIM16650861T','MK01'),
('OSUIM16650862L','MK01'),
('OSUIM16650862T','MK01'),
('OSUIM18850861L','HERB'),
('OSUIM18850861T','HERB'),
('OSUIM18850862L','HERB'),
('OSUIM18850862T','HERB'),
('OSUIM18850862T-TE','HERB'),
('OSUIM4001041T','WSB1'),
('OSUIM40060155141L','TB3'),
('OSUIM40060155141L-TE','TB3'),
('OSUIM40060155141T','TB3'),
('OSUIM400841T','MK01'),
('OSUIM400841T-TE','MK01'),
('OSUIM400861T','MK01'),
('OSUIM50013101T','HERB'),
('OSUIM5001361T','HERB'),
('OSUIM500941T','WSB1'),
('OSUIM7001261L','HERB'),
('OSUIM7001261T','HERB'),
('OSUIM90016121T','TB2'),
('OSUIM90016121T-TE','TB2'),
('OSUIM90016141T','TB2'),
('OSUIM90016141T-TE','TB2'),
('OSUNP50013101T','HERB'),
('OSUNP50013101T-TE','HERB'),
('OSUNP5008101T','HERB'),
('OSUNP5008101T-TE','HERB'),
('OSUNP6009121T','HERB'),
('OSUNP6009121T-TE','HERB'),
('OSUNP65010141T','HERB'),
('OSUNP65010141T-TE','HERB'),
('OSUNP70012141T','HERB'),
('OSUNP70012141T-TE','HERB'),
('OSUNP81515141T','TB1'),
('OSUNP81515141T-TE','TB1'),
('OSUSG1122481I','MK04'),
('OSUSG1122481T','MK04'),
('OSUSG1122881T','MK04'),
('OSUSG12424101T','MK04'),
('OSUSG12424121T','MK04'),
('OSUSG1242481I','MK04'),
('OSUSG1242481T','MK04'),
('OSUSG12428181T','MK04'),
('OSUSG12428181T-TE','MK04'),
('OSUSG12428181T-X','MK04'),
('OSUSG1243281T','MK04'),
('OSUSG13628121T','MK04'),
('OSUSG1362881T','MK04'),
('OSUSG1492481T','MK04'),
('OSUSG1492481T-ARCH','MK04'),
('OSUSG1492881T','MK04'),
('OSUSG1492881T-TE','MK04'),
('OSUSG15538101T','MK06'),
('OSUSG15538101T-TE','MK06'),
('OSUSG16928101I','MK05'),
('OSUSG16928101T','MK05'),
('OSUSG16930121I','MK05'),
('OSUSG16930121T','MK05'),
('OSUSG16930141T','MK05'),
('OSUSG16930142T','MK05'),
('OSUSG16930142T-TE','MK05'),
('OSUSG1693081T','MK05'),
('OSUSG16934121T','MK06'),
('OSUSG16934141I','MK06'),
('OSUSG16934141T','MK06'),
('OSUSG18430121T','MK05'),
('OSUSG18430141T','MK05'),
('OSUSG18430141T-TE','MK05'),
('OSUSG18430142T','MK05'),
('OSUSG18430142T-TE','MK05'),
('OSUSG18434121T','MK06'),
('OSUSG18434141I','MK06'),
('OSUSG18434141T','MK06'),
('OSUSG4001041T','WSB1'),
('OSUSG40060155142L','TB3'),
('OSUSG40060155142L-TE','TB3'),
('OSUSG6001661T','MK03'),
('OSUSG6001681T','MK03'),
('OSUSG7501661T','MK02'),
('OSUSG7501681T','MK02'),
('OSUSG7501681T-TE','MK02'),
('OSUSG952481T','MK04'),
('OSUSG952481T-TE','MK04'),
('OSUSG953261T','MK05'),
('OSUSG953281T','MK05'),
('OSUSG9536101T','MK06'),
('OSUSG953661T','MK06'),
('OSUSR6001661T','MK03'),
('OSUSR6001662T','MK03'),
('OSUSR6001681T','MK03'),
('OSUSR6001682T','MK03'),
('OSUSR6001861T','MK03'),
('OSUSR7501661T','MK02'),
('OSUSR7501662T','MK02'),
('OSUSR7501681I','MK02'),
('OSUSR7501681T','MK02'),
('OSUSR7501682T','MK02'),
('OSUSR7501862T','MK02'),
('OSUSR7501882T','MK02'),
('OSUSR7501882T-TE','MK02'),
('OSUSR7502081T','TB3');






declare c cursor fast_forward for
select ProductNo,WorkCenterNo from @tabConvert

open c;
fetch next from c into @ProductNo,@WorkCenterNo;

   while @@fetch_status = 0
   begin
    --
	set @WorkCenterId = ( select r.id from [dbo].[Resources] as r where r.ResourceNumber = @WorkCenterNo )
	
	print @ProductNo;
	print @WorkCenterNo;
	print @WorkCenterId;

	UPDATE r
	set r.WorkCenterId = @WorkCenterId
  FROM [MwTech].[dbo].[ManufactoringRoutes] as r
  inner join [MwTech].[dbo].[ProductVersions] as pv
  on pv.Id = r.ProductVersionId
  inner join [MwTech].[dbo].[Products] as pr
  on pr.Id = pv.ProductId
  where r.OperationId = @OperationId 
  and pr.ProductNumber = @ProductNo

	--
   	fetch next from c into  @ProductNo,@WorkCenterNo;
   end

   close c;
   deallocate c;








